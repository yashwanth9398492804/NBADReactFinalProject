{"ast":null,"code":"import '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { getActiveElementOrBody } from '../utils/focus/getActiveElement.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\nfunction _define_property(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nvar DOM_KEY_LOCATION;\n(function (DOM_KEY_LOCATION) {\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"STANDARD\"] = 0] = \"STANDARD\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"LEFT\"] = 1] = \"LEFT\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"RIGHT\"] = 2] = \"RIGHT\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"NUMPAD\"] = 3] = \"NUMPAD\";\n})(DOM_KEY_LOCATION || (DOM_KEY_LOCATION = {}));\nconst modifierKeys = ['Alt', 'AltGraph', 'Control', 'Fn', 'Meta', 'Shift', 'Symbol'];\nfunction isModifierKey(key) {\n  return modifierKeys.includes(key);\n}\nconst modifierLocks = ['CapsLock', 'FnLock', 'NumLock', 'ScrollLock', 'SymbolLock'];\nfunction isModifierLock(key) {\n  return modifierLocks.includes(key);\n}\nclass KeyboardHost {\n  isKeyPressed(keyDef) {\n    return !!this.pressed[String(keyDef.code)];\n  }\n  getPressedKeys() {\n    return Object.values(this.pressed).map(p => p.keyDef);\n  }\n  /** Press a key */\n  async keydown(instance, keyDef) {\n    var\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      _this_pressed, _code, _this_pressed_code;\n    const key = String(keyDef.key);\n    const code = String(keyDef.code);\n    const target = getActiveElementOrBody(instance.config.document);\n    this.setKeydownTarget(target);\n    var _;\n    (_ = (_this_pressed = this.pressed)[_code = code]) !== null && _ !== void 0 ? _ : _this_pressed[_code] = {\n      keyDef,\n      unpreventedDefault: false\n    };\n    if (isModifierKey(key)) {\n      this.modifiers[key] = true;\n    }\n    const unprevented = instance.dispatchUIEvent(target, 'keydown', {\n      key,\n      code\n    });\n    if (isModifierLock(key) && !this.modifiers[key]) {\n      this.modifiers[key] = true;\n      this.modifierLockStart[key] = true;\n    }\n    (_this_pressed_code = this.pressed[code]).unpreventedDefault || (_this_pressed_code.unpreventedDefault = unprevented);\n    if (unprevented && this.hasKeyPress(key)) {\n      instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keypress', {\n        key,\n        code,\n        charCode: keyDef.key === 'Enter' ? 13 : String(keyDef.key).charCodeAt(0)\n      });\n    }\n  }\n  /** Release a key */\n  async keyup(instance, keyDef) {\n    const key = String(keyDef.key);\n    const code = String(keyDef.code);\n    const unprevented = this.pressed[code].unpreventedDefault;\n    // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n    delete this.pressed[code];\n    if (isModifierKey(key) && !Object.values(this.pressed).find(p => p.keyDef.key === key)) {\n      this.modifiers[key] = false;\n    }\n    instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keyup', {\n      key,\n      code\n    }, !unprevented);\n    if (isModifierLock(key) && this.modifiers[key]) {\n      if (this.modifierLockStart[key]) {\n        this.modifierLockStart[key] = false;\n      } else {\n        this.modifiers[key] = false;\n      }\n    }\n  }\n  setKeydownTarget(target) {\n    if (target !== this.lastKeydownTarget) {\n      this.carryChar = '';\n    }\n    this.lastKeydownTarget = target;\n  }\n  hasKeyPress(key) {\n    return (key.length === 1 || key === 'Enter') && !this.modifiers.Control && !this.modifiers.Alt;\n  }\n  constructor(system) {\n    _define_property(this, \"system\", void 0);\n    _define_property(this, \"modifiers\", {\n      Alt: false,\n      AltGraph: false,\n      CapsLock: false,\n      Control: false,\n      Fn: false,\n      FnLock: false,\n      Meta: false,\n      NumLock: false,\n      ScrollLock: false,\n      Shift: false,\n      Symbol: false,\n      SymbolLock: false\n    });\n    _define_property(this, \"pressed\", {});\n    _define_property(this, \"carryChar\", '');\n    _define_property(this, \"lastKeydownTarget\", undefined);\n    _define_property(this, \"modifierLockStart\", {});\n    this.system = system;\n  }\n}\nexport { DOM_KEY_LOCATION, KeyboardHost };","map":{"version":3,"names":["getActiveElementOrBody","_define_property","obj","key","value","Object","defineProperty","enumerable","configurable","writable","DOM_KEY_LOCATION","modifierKeys","isModifierKey","includes","modifierLocks","isModifierLock","KeyboardHost","isKeyPressed","keyDef","pressed","String","code","getPressedKeys","values","map","p","keydown","instance","_this_pressed","_code","_this_pressed_code","target","config","document","setKeydownTarget","_","unpreventedDefault","modifiers","unprevented","dispatchUIEvent","modifierLockStart","hasKeyPress","charCode","charCodeAt","keyup","find","lastKeydownTarget","carryChar","length","Control","Alt","constructor","system","AltGraph","CapsLock","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock","undefined"],"sources":["C:/NBAD/Y1/node_modules/@testing-library/user-event/dist/esm/system/keyboard.js"],"sourcesContent":["import '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { getActiveElementOrBody } from '../utils/focus/getActiveElement.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\n\nfunction _define_property(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\nvar DOM_KEY_LOCATION;\n(function(DOM_KEY_LOCATION) {\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"STANDARD\"] = 0] = \"STANDARD\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"LEFT\"] = 1] = \"LEFT\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"RIGHT\"] = 2] = \"RIGHT\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"NUMPAD\"] = 3] = \"NUMPAD\";\n})(DOM_KEY_LOCATION || (DOM_KEY_LOCATION = {}));\nconst modifierKeys = [\n    'Alt',\n    'AltGraph',\n    'Control',\n    'Fn',\n    'Meta',\n    'Shift',\n    'Symbol'\n];\nfunction isModifierKey(key) {\n    return modifierKeys.includes(key);\n}\nconst modifierLocks = [\n    'CapsLock',\n    'FnLock',\n    'NumLock',\n    'ScrollLock',\n    'SymbolLock'\n];\nfunction isModifierLock(key) {\n    return modifierLocks.includes(key);\n}\nclass KeyboardHost {\n    isKeyPressed(keyDef) {\n        return !!this.pressed[String(keyDef.code)];\n    }\n    getPressedKeys() {\n        return Object.values(this.pressed).map((p)=>p.keyDef);\n    }\n    /** Press a key */ async keydown(instance, keyDef) {\n        var // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        _this_pressed, _code, _this_pressed_code;\n        const key = String(keyDef.key);\n        const code = String(keyDef.code);\n        const target = getActiveElementOrBody(instance.config.document);\n        this.setKeydownTarget(target);\n        var _;\n        (_ = (_this_pressed = this.pressed)[_code = code]) !== null && _ !== void 0 ? _ : _this_pressed[_code] = {\n            keyDef,\n            unpreventedDefault: false\n        };\n        if (isModifierKey(key)) {\n            this.modifiers[key] = true;\n        }\n        const unprevented = instance.dispatchUIEvent(target, 'keydown', {\n            key,\n            code\n        });\n        if (isModifierLock(key) && !this.modifiers[key]) {\n            this.modifiers[key] = true;\n            this.modifierLockStart[key] = true;\n        }\n        (_this_pressed_code = this.pressed[code]).unpreventedDefault || (_this_pressed_code.unpreventedDefault = unprevented);\n        if (unprevented && this.hasKeyPress(key)) {\n            instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keypress', {\n                key,\n                code,\n                charCode: keyDef.key === 'Enter' ? 13 : String(keyDef.key).charCodeAt(0)\n            });\n        }\n    }\n    /** Release a key */ async keyup(instance, keyDef) {\n        const key = String(keyDef.key);\n        const code = String(keyDef.code);\n        const unprevented = this.pressed[code].unpreventedDefault;\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete this.pressed[code];\n        if (isModifierKey(key) && !Object.values(this.pressed).find((p)=>p.keyDef.key === key)) {\n            this.modifiers[key] = false;\n        }\n        instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keyup', {\n            key,\n            code\n        }, !unprevented);\n        if (isModifierLock(key) && this.modifiers[key]) {\n            if (this.modifierLockStart[key]) {\n                this.modifierLockStart[key] = false;\n            } else {\n                this.modifiers[key] = false;\n            }\n        }\n    }\n    setKeydownTarget(target) {\n        if (target !== this.lastKeydownTarget) {\n            this.carryChar = '';\n        }\n        this.lastKeydownTarget = target;\n    }\n    hasKeyPress(key) {\n        return (key.length === 1 || key === 'Enter') && !this.modifiers.Control && !this.modifiers.Alt;\n    }\n    constructor(system){\n        _define_property(this, \"system\", void 0);\n        _define_property(this, \"modifiers\", {\n            Alt: false,\n            AltGraph: false,\n            CapsLock: false,\n            Control: false,\n            Fn: false,\n            FnLock: false,\n            Meta: false,\n            NumLock: false,\n            ScrollLock: false,\n            Shift: false,\n            Symbol: false,\n            SymbolLock: false\n        });\n        _define_property(this, \"pressed\", {});\n        _define_property(this, \"carryChar\", '');\n        _define_property(this, \"lastKeydownTarget\", undefined);\n        _define_property(this, \"modifierLockStart\", {});\n        this.system = system;\n    }\n}\n\nexport { DOM_KEY_LOCATION, KeyboardHost };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}